<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" href="/favicon.svg"><script>!function(){const e=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,t=localStorage.getItem("vueuse-color-scheme")||"auto";("dark"===t||e&&"light"!==t)&&document.documentElement.classList.toggle("dark",!0)}()</script><style type="text/css">:root{color-scheme:light dark;--va-c-bg:#fff}html.dark{--va-c-bg:#000}html{background-color:var(--va-c-bg)}</style><script>const locale=localStorage.getItem("valaxy-locale")||"zh-CN";document.documentElement.setAttribute("lang",locale)</script><script type="module" async="" crossorigin="" src="/assets/app.UZrFpIJB.js"></script><link rel="modulepreload" crossorigin="" href="/assets/framework.CwRAi3M2.js"><link rel="modulepreload" crossorigin="" href="/assets/chunks/@vueuse/motion.DgOGrpK1.js"><link rel="modulepreload" crossorigin="" href="/assets/chunks/vue-router.SU_9AcH3.js"><link rel="modulepreload" crossorigin="" href="/assets/chunks/dayjs.DRNXKsfK.js"><link rel="modulepreload" crossorigin="" href="/assets/chunks/vue-i18n.CrAQ0PxR.js"><link rel="modulepreload" crossorigin="" href="/assets/chunks/pinia.ZhWIb4h5.js"><link rel="modulepreload" crossorigin="" href="/assets/chunks/nprogress.Y9-A6VbA.js"><link rel="stylesheet" crossorigin="" href="/assets/app.BxhG5gh6.css"><link rel="stylesheet" crossorigin="" href="/assets/group-icons.DLBb7Rhi.css"><link rel="modulepreload" crossorigin="" href="/assets/post.CRFNtzU-.js"><link rel="stylesheet" href="/assets/group-icons.DLBb7Rhi.css"><link rel="modulepreload" crossorigin="" href="/assets/2025-07-24-homelab.W2SuR4NP.js"><title>Building a Modern Homelab with Free Domain and Cloudflare Zero Trust - djzzlim's blog~</title><script id="check-mac-os" async="">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform))</script><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap"><meta property="og:locale:alternate" content="en"><meta name="description" content="所以一直在记录"><meta property="og:description" content="所以一直在记录"><meta property="og:locale" content="zh-CN"><meta property="og:site_name" content="djzzlim's blog~"><meta property="og:title" content="Building a Modern Homelab with Free Domain and Cloudflare Zero Trust"><meta property="og:image" content="/favicon.svg"><meta property="og:type" content="website"><meta property="og:url" content="https://djzzlim.github.io/"><link rel="icon" href="/favicon.svg" type="image/svg+xml"><meta name="generator" content="Valaxy 0.26.10"><meta name="theme-color" content="#fff"><meta name="msapplication-TileColor" content="#fff"><meta name="twitter:card" content="summary_large_image"></head><body><div id="app" data-server-rendered="true"><!--[--><!--[--><!--[--><!----><!----><div class="yun-page-header-gradient" style="--gradient-from:161 196 253;--gradient-to:194 233 251"></div><!----><!----><!----><canvas class="fireworks"></canvas><!--[--><div class="yun-bg"></div><!--]--><div class="yun-page-loading" absolute="" left-0="" right-0="" bottom-0="" top-0="" flex="" justify="center" items-center="" z-10="" bg="$va-c-bg" data-v-673bc094=""><div class="spinner" data-v-673bc094=""></div></div><a href="#" class="back-to-top yun-icon-btn bg-$va-c-bg-soft shadow-md"><div class="size-8" i-ri-arrow-up-s-line=""></div><svg class="progress-circle-container" viewBox="0 0 100 100"><circle stroke-dasharray="301.59289474462014 301.59289474462014" stroke-dashoffset="301.59289474462014" stroke="currentColor" stroke-width="2" stroke-linecap="round" class="progress-circle" cx="50" cy="50" r="48" fill="none"></circle></svg></a><!-- TODO --><!-- <YunDock /> --><!--]--><!--[--><!--]--><!----><!--]--><!--[--><div flex="~" class="w-full m-auto justify-center items-start gap-4 mt-12 md:mt-24"><!--[--><!----><main class="yun-main lt-md:w-full" flex="~ center"><!--[--><div class="content w-full md:w-3xl lg:w-2xl xl:w-2xl 2xl:w-4xl" flex="~ col grow" p="lt-md:0"><div class="yun-card flex-center rounded-2 relative" flex="col" min-h="100px" bg="$va-c-bg-light" m="0" style=""><!----><!----><!--[--><div class="mt-8 mb-4"><!--[--><header class="post-header"><h1 p="2" text="2xl center" font="serif black" style="" class="post-title flex-center"><!----><span inline-flex="" class="leading-none">Building a Modern Homelab with Free Domain and Cloudflare Zero Trust</span></h1></header><!--]--></div><!--[--><!--[--><!--[--><!--[--><!----><!----><!----><div flex="~ center" text="sm" class="flex-col gap-2! post-meta gap-4"><div class="post-time flex items-center gap-4"><span class="posted-time inline-flex-center gap-1" title="发表于2025-07-24 08:00:00"><div class="inline-block" i-ri-calendar-line=""></div><time class="op-80">2025-07-24</time></span><!----></div><!--[--><!--]--><div class="inline-flex-center gap-4"><!----><!----></div></div><!--]--><div class="inline-flex mt-2" text="sm" py="1"><a href="/categories?category=%E6%8A%80%E6%9C%AF%E6%95%99%E7%A8%8B" class="transition post-category inline-flex-center text-xs border-$va-c-divider" px-2="" h="7" border="" rounded-full="" hover="bg-blue-500 text-white"><div m="x-1" inline-flex="" i-ri-folder-2-line=""></div><span>技术教程</span></a><span mx="2"></span><div class="post-tags inline-flex" items="center" gap="1" flex="wrap 1" justify="end"><!--[--><a href="/tags/?tag=Homelab" class="transition post-tag inline-flex-center text-xs border-$va-c-divider" px-2="" h="7" rounded-full="" border="" hover="bg-blue-500 text-white"><span>Homelab</span></a><a href="/tags/?tag=%E5%AE%B6%E5%BA%AD%E5%AE%9E%E9%AA%8C%E5%AE%A4" class="transition post-tag inline-flex-center text-xs border-$va-c-divider" px-2="" h="7" rounded-full="" border="" hover="bg-blue-500 text-white"><span>家庭实验室</span></a><a href="/tags/?tag=Cloudflare" class="transition post-tag inline-flex-center text-xs border-$va-c-divider" px-2="" h="7" rounded-full="" border="" hover="bg-blue-500 text-white"><span>Cloudflare</span></a><a href="/tags/?tag=%E8%87%AA%E5%8A%A8%E5%8C%96" class="transition post-tag inline-flex-center text-xs border-$va-c-divider" px-2="" h="7" rounded-full="" border="" hover="bg-blue-500 text-white"><span>自动化</span></a><a href="/tags/?tag=%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8" class="transition post-tag inline-flex-center text-xs border-$va-c-divider" px-2="" h="7" rounded-full="" border="" hover="bg-blue-500 text-white"><span>网络安全</span></a><a href="/tags/?tag=Self-hosting" class="transition post-tag inline-flex-center text-xs border-$va-c-divider" px-2="" h="7" rounded-full="" border="" hover="bg-blue-500 text-white"><span>Self-hosting</span></a><!--]--></div></div><!--]--><!--]--><!--]--><div p="x-4 b-8" class="sm:px-6 lg:px-12 xl:px-16" w="full"><!--[--><!--]--><!--[--><!-- <Transition appear> --><article class="markdown-body"><!--[--><!----><!----><!--[--><!--]--><!--[--><div lang="zh-CN"><h2 lang="zh-CN" id="前言" tabindex="-1">前言 <a class="header-anchor" href="#前言" aria-label="Permalink to &quot;前言 {lang=&quot;zh-CN&quot;}&quot;">​</a></h2><p>作为一个喜欢折腾的技术爱好者，我一直想要搭建一个属于自己的家庭实验室（Homelab）。既要能在本地网络中使用，又要能通过互联网安全访问，还要有自动化功能来提高效率。经过一番研究和实践，我成功搭建了一套基于免费域名和 Cloudflare Zero Trust 的现代化 Homelab 方案。</p><hr><h2 lang="zh-CN" id="为什么选择这套方案" tabindex="-1">为什么选择这套方案？ <a class="header-anchor" href="#为什么选择这套方案" aria-label="Permalink to &quot;为什么选择这套方案？ {lang=&quot;zh-CN&quot;}&quot;">​</a></h2><p>市面上有很多 Homelab 解决方案，但大多数要么需要昂贵的域名和证书，要么安全性不够好。我选择这套方案的原因：</p><ol><li><strong>完全免费</strong> - 使用 DigitalPlat FreeDomain 获取免费域名</li><li><strong>安全可靠</strong> - Cloudflare Zero Trust 提供企业级安全保护</li><li><strong>易于管理</strong> - 统一的 Web 界面管理所有服务</li><li><strong>高度自动化</strong> - n8n 工作流自动化，定时备份</li><li><strong>隐私保护</strong> - Pi-hole + Unbound 组合保护 DNS 隐私</li></ol><blockquote><p>"最好的 Homelab 方案不是最贵的，而是最适合自己的。"</p></blockquote><hr><h2 lang="zh-CN" id="硬件配置与架构" tabindex="-1">硬件配置与架构 <a class="header-anchor" href="#硬件配置与架构" aria-label="Permalink to &quot;硬件配置与架构 {lang=&quot;zh-CN&quot;}&quot;">​</a></h2><p>我的 Homelab 采用了混合架构，主要包括：</p><h3 lang="zh-CN" id="主服务器配置" tabindex="-1">主服务器配置 <a class="header-anchor" href="#主服务器配置" aria-label="Permalink to &quot;主服务器配置 {lang=&quot;zh-CN&quot;}&quot;">​</a></h3><ul><li><strong>CPU</strong>: Intel i5-6600T 处理器</li><li><strong>内存</strong>: 12GB DDR4</li><li><strong>存储</strong>: 256GB SSD</li><li><strong>网络</strong>: WiFi 连接</li></ul><h3 lang="zh-CN" id="辅助设备" tabindex="-1">辅助设备 <a class="header-anchor" href="#辅助设备" aria-label="Permalink to &quot;辅助设备 {lang=&quot;zh-CN&quot;}&quot;">​</a></h3><ul><li><strong>Raspberry Pi Zero 2W</strong>: 作为 DNS 服务器和轻量级服务的节能方案</li><li><strong>Tailscale VPN</strong>: 连接所有设备形成私有网络</li></ul><hr><h2 lang="zh-CN" id="核心服务架构" tabindex="-1">核心服务架构 <a class="header-anchor" href="#核心服务架构" aria-label="Permalink to &quot;核心服务架构 {lang=&quot;zh-CN&quot;}&quot;">​</a></h2><h3 lang="zh-CN" id="主服务器服务列表" tabindex="-1">主服务器服务列表 <a class="header-anchor" href="#主服务器服务列表" aria-label="Permalink to &quot;主服务器服务列表 {lang=&quot;zh-CN&quot;}&quot;">​</a></h3><table><thead><tr><th>服务名称</th><th>域名</th><th>端口</th><th>功能描述</th></tr></thead><tbody><tr><td><strong>Syncthing</strong></td><td>syncthing.example.dpdns.org</td><td>8384</td><td>文件同步服务</td></tr><tr><td><strong>Cockpit</strong></td><td>cockpit.example.dpdns.org</td><td>9090</td><td>系统监控面板</td></tr><tr><td><strong>Portainer</strong></td><td>portainer.example.dpdns.org</td><td>9443</td><td>Docker 容器管理</td></tr><tr><td><strong>Nextcloud</strong></td><td>nextcloud.example.dpdns.org</td><td>80</td><td>私have云存储</td></tr><tr><td><strong>n8n</strong></td><td>n8n.example.dpdns.org</td><td>5678</td><td>工作流自动化</td></tr><tr><td><strong>Ollama</strong></td><td>ollama.example.dpdns.org</td><td>11434</td><td>本地 AI 模型服务</td></tr></tbody></table><h3 lang="zh-CN" id="pi-zero-2w-服务列表" tabindex="-1">Pi Zero 2W 服务列表 <a class="header-anchor" href="#pi-zero-2w-服务列表" aria-label="Permalink to &quot;Pi Zero 2W 服务列表 {lang=&quot;zh-CN&quot;}&quot;">​</a></h3><table><thead><tr><th>服务名称</th><th>域名</th><th>端口</th><th>功能描述</th></tr></thead><tbody><tr><td><strong>Pi Syncthing</strong></td><td>pi-syncthing.example.dpdns.org</td><td>8384</td><td>备用文件同步</td></tr><tr><td><strong>Pi-hole</strong></td><td>pihole.example.dpdns.org</td><td>80</td><td>DNS 广告拦截</td></tr></tbody></table><hr><h2 lang="zh-CN" id="免费域名申请与配置" tabindex="-1">免费域名申请与配置 <a class="header-anchor" href="#免费域名申请与配置" aria-label="Permalink to &quot;免费域名申请与配置 {lang=&quot;zh-CN&quot;}&quot;">​</a></h2><h3 lang="zh-CN" id="第一步-申请-digitalplat-freedomain" tabindex="-1">第一步：申请 DigitalPlat FreeDomain <a class="header-anchor" href="#第一步-申请-digitalplat-freedomain" aria-label="Permalink to &quot;第一步：申请 DigitalPlat FreeDomain {lang=&quot;zh-CN&quot;}&quot;">​</a></h3><ol><li>访问 <strong>DigitalPlat FreeDomain – NIC</strong> 官网</li><li>选择合适的免费域名后缀（我选择了 <code>.dpdns.org</code>）</li><li>注册域名（使用通用示例域名，避免暴露真实信息）</li><li>完成域名验证</li></ol><h3 lang="zh-CN" id="第二步-迁移到-cloudflare" tabindex="-1">第二步：迁移到 Cloudflare <a class="header-anchor" href="#第二步-迁移到-cloudflare" aria-label="Permalink to &quot;第二步：迁移到 Cloudflare {lang=&quot;zh-CN&quot;}&quot;">​</a></h3><ol><li>在 Cloudflare 中添加域名</li><li>将 DigitalPlat 的 Name Servers 改为 Cloudflare 提供的 NS</li><li>等待 DNS 传播完成（通常需要 24-48 小时）</li></ol><blockquote><p><strong>小贴士</strong>：免费域名虽然功能有限，但对于 Homelab 来说完全够用。</p></blockquote><hr><h2 lang="zh-CN" id="cloudflare-zero-trust-隧道配置" tabindex="-1">Cloudflare Zero Trust 隧道配置 <a class="header-anchor" href="#cloudflare-zero-trust-隧道配置" aria-label="Permalink to &quot;Cloudflare Zero Trust 隧道配置 {lang=&quot;zh-CN&quot;}&quot;">​</a></h2><h3 lang="zh-CN" id="使用-web-gui-配置隧道" tabindex="-1">使用 Web GUI 配置隧道 <a class="header-anchor" href="#使用-web-gui-配置隧道" aria-label="Permalink to &quot;使用 Web GUI 配置隧道 {lang=&quot;zh-CN&quot;}&quot;">​</a></h3><p>我选择通过 Cloudflare Zero Trust 的 Web 界面来配置隧道，这种方式更加直观和方便：</p><ol><li><p><strong>登录 Cloudflare Zero Trust 控制台</strong></p></li><li><p><strong>创建隧道</strong>：</p><ul><li>进入 Access → Tunnels</li><li>点击 "Create a tunnel"</li><li>选择 "Cloudflared" 作为连接器类型</li><li>为隧道命名（如 "homelab-main"）</li></ul></li><li><p><strong>安装 Cloudflared</strong>：</p><div class="language-bash"><button title="Copy code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code v-pre=""><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Ubuntu/Debian - 按照控制台显示的命令</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -L</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --output</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cloudflared.deb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-amd64.deb</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dpkg</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cloudflared.deb</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 运行控制台提供的连接命令</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cloudflared</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> install</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [YOUR_TOKEN_HERE]</span></span></code></pre><button class="code-block-unfold-btn"></button></div></li><li><p><strong>配置公共主机名</strong>： 在 Web 界面中添加以下服务映射：</p><ul><li><code>syncthing.example.dpdns.org</code> → <code>http://localhost:8384</code></li><li><code>cockpit.example.dpdns.org</code> → <code>https://localhost:9090</code></li><li><code>portainer.example.dpdns.org</code> → <code>https://localhost:9443</code></li><li><code>nextcloud.example.dpdns.org</code> → <code>http://localhost:80</code></li><li><code>n8n.example.dpdns.org</code> → <code>http://localhost:5678</code></li><li><code>ollama.example.dpdns.org</code> → <code>http://127.0.0.1:11434</code></li></ul></li></ol><hr><h2 lang="zh-CN" id="核心服务部署详解" tabindex="-1">核心服务部署详解 <a class="header-anchor" href="#核心服务部署详解" aria-label="Permalink to &quot;核心服务部署详解 {lang=&quot;zh-CN&quot;}&quot;">​</a></h2><h3 lang="zh-CN" id="_1-文件同步服务-syncthing" tabindex="-1">1. 文件同步服务 - Syncthing <a class="header-anchor" href="#_1-文件同步服务-syncthing" aria-label="Permalink to &quot;1. 文件同步服务 - Syncthing {lang=&quot;zh-CN&quot;}&quot;">​</a></h3><p><strong>为什么选择 Syncthing？</strong></p><ul><li>去中心化，无需第三方服务器</li><li>端到端加密，隐私安全</li><li>跨平台支持，设备间无缝同步</li></ul><p><strong>APT 安装配置：</strong></p><div class="language-bash"><button title="Copy code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code v-pre=""><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 添加官方 APT 源</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /etc/apt/keyrings</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -L</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /etc/apt/keyrings/syncthing-archive-keyring.gpg</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> https://syncthing.net/release-key.gpg</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "deb [signed-by=/etc/apt/keyrings/syncthing-archive-keyring.gpg] https://apt.syncthing.net/ syncthing stable"</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tee</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /etc/apt/sources.list.d/syncthing.list</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 安装 Syncthing</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> update</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> syncthing</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 启用系统服务</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> syncthing@</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$USER</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> syncthing@</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$USER</span></span></code></pre><button class="code-block-unfold-btn"></button></div><p>通过 Syncthing，我的所有设备（手机、笔记本、服务器）都能保持文件同步，再也不用担心文件丢失或版本混乱。</p><h3 lang="zh-CN" id="_2-工作流自动化-n8n-docker" tabindex="-1">2. 工作流自动化 - n8n (Docker) <a class="header-anchor" href="#_2-工作流自动化-n8n-docker" aria-label="Permalink to &quot;2. 工作流自动化 - n8n (Docker) {lang=&quot;zh-CN&quot;}&quot;">​</a></h3><p><strong>Docker 部署 n8n：</strong></p><div class="language-bash"><button title="Copy code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code v-pre=""><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 创建数据目录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> volume</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> n8n_data</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 运行 n8n 容器</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> n8n</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --network=host</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> n8n_data:/home/node/.n8n</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> N8N_HOST=n8n.example.dpdns.org</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> WEBHOOK_URL=https://n8n.example.dpdns.org</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> VUE_APP_URL_BASE_API=https://n8n.example.dpdns.org</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> N8N_PROTOCOL=https</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> N8N_SECURE_COOKIE=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">false</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> N8N_LISTEN_ADDRESS=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0.0.0.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> N8N_RUNNERS_ENABLED=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> N8N_ENFORCE_SETTINGS_FILE_PERMISSIONS=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> unless-stopped</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  docker.n8n.io/n8nio/n8n</span></span></code></pre><button class="code-block-unfold-btn"></button></div><p><strong>我的自动化场景：</strong></p><ul><li><strong>文件备份自动化</strong>：检测到重要文件变动时，自动备份到云端</li><li><strong>系统监控告警</strong>：服务器资源异常时，自动发送通知到手机</li><li><strong>定时任务管理</strong>：自动清理临时文件，更新系统补丁</li></ul><h3 lang="zh-CN" id="_3-容器管理-portainer-docker" tabindex="-1">3. 容器管理 - Portainer (Docker) <a class="header-anchor" href="#_3-容器管理-portainer-docker" aria-label="Permalink to &quot;3. 容器管理 - Portainer (Docker) {lang=&quot;zh-CN&quot;}&quot;">​</a></h3><p><strong>Docker 部署 Portainer：</strong></p><div class="language-bash"><button title="Copy code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code v-pre=""><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 创建数据卷</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> volume</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> portainer_data</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 运行 Portainer 容器</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 8000:8000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 9443:9443</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> portainer</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --restart=always</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /var/run/docker.sock:/var/run/docker.sock</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> portainer_data:/data</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  portainer/portainer-ce:lts</span></span></code></pre><button class="code-block-unfold-btn"></button></div><h3 lang="zh-CN" id="_4-dns-过滤与隐私保护-pi-hole-unbound" tabindex="-1">4. DNS 过滤与隐私保护 - Pi-hole + Unbound <a class="header-anchor" href="#_4-dns-过滤与隐私保护-pi-hole-unbound" aria-label="Permalink to &quot;4. DNS 过滤与隐私保护 - Pi-hole + Unbound {lang=&quot;zh-CN&quot;}&quot;">​</a></h3><p><strong>Pi-hole 配置：</strong></p><div class="language-bash"><button title="Copy code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code v-pre=""><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 安装 Pi-hole</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -sSL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> https://install.pi-hole.net</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> bash</span></span></code></pre><button class="code-block-unfold-btn"></button></div><p><strong>Unbound 配置（参考官方文档）：</strong></p><p>根据 <a href="https://docs.pi-hole.net/guides/dns/unbound/" target="_blank" rel="noreferrer">Pi-hole 官方 Unbound 指南</a>：</p><div class="language-bash"><button title="Copy code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code v-pre=""><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 安装 Unbound</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> unbound</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 创建配置文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /etc/unbound/unbound.conf.d/pi-hole.conf</span></span></code></pre><button class="code-block-unfold-btn"></button></div><p><strong>配置内容：</strong></p><div class="language-"><button title="Copy code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code v-pre=""><span class="line"><span>server:</span></span>
<span class="line"><span>    # If no logfile is specified, syslog is used</span></span>
<span class="line"><span>    # logfile: "/var/log/unbound/unbound.log"</span></span>
<span class="line"><span>    verbosity: 0</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    interface: 127.0.0.1</span></span>
<span class="line"><span>    port: 5335</span></span>
<span class="line"><span>    do-ip4: yes</span></span>
<span class="line"><span>    do-udp: yes</span></span>
<span class="line"><span>    do-tcp: yes</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # May be set to no if you don't have IPv6 connectivity</span></span>
<span class="line"><span>    do-ip6: yes</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # You want to leave this to no unless you have *native* IPv6. With 6to4 and</span></span>
<span class="line"><span>    # Terredo tunnels your web browser should favor IPv4 for the same reasons</span></span>
<span class="line"><span>    prefer-ip6: no</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # Use this only when you downloaded the list of primary root servers!</span></span>
<span class="line"><span>    # If you use the default dns-root-data package, unbound will find it automatically</span></span>
<span class="line"><span>    #root-hints: "/var/lib/unbound/root.hints"</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # Trust glue only if it is within the server's authority</span></span>
<span class="line"><span>    harden-glue: yes</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # Require DNSSEC data for trust-anchored zones, if such data is absent, the zone becomes BOGUS</span></span>
<span class="line"><span>    harden-dnssec-stripped: yes</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # Don't use Capitalization randomization as it known to cause DNSSEC issues sometimes</span></span>
<span class="line"><span>    # see https://discourse.pi-hole.net/t/unbound-stubby-or-dnscrypt-proxy/9378 for further details</span></span>
<span class="line"><span>    use-caps-for-id: no</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # Reduce EDNS reassembly buffer size.</span></span>
<span class="line"><span>    # IP fragmentation is unreliable on the Internet today, and can cause</span></span>
<span class="line"><span>    # transmission failures when large DNS messages are sent via UDP. Even</span></span>
<span class="line"><span>    # when fragmentation does work, it may not be secure; it is theoretically</span></span>
<span class="line"><span>    # possible to spoof parts of a fragmented DNS message, without easy</span></span>
<span class="line"><span>    # detection at the receiving end. Recently, there was an excellent study</span></span>
<span class="line"><span>    # &gt;&gt;&gt; Defragmenting DNS - Determining the optimal maximum UDP response size for DNS &lt;&lt;&lt;</span></span>
<span class="line"><span>    # by Axel Koolhaas, and Tjeerd Slokker (https://indico.dns-oarc.net/event/36/contributions/776/)</span></span>
<span class="line"><span>    # in collaboration with NLnet Labs explored DNS using real world data from the</span></span>
<span class="line"><span>    # the RIPE Atlas probes and the researchers suggested different values for</span></span>
<span class="line"><span>    # IPv4 and IPv6 and in different scenarios. They advise that servers should</span></span>
<span class="line"><span>    # be configured to limit DNS messages sent over UDP to a size that will not</span></span>
<span class="line"><span>    # trigger fragmentation on typical network links. DNS servers can switch</span></span>
<span class="line"><span>    # from UDP to TCP when a DNS response is too big to fit in this limited</span></span>
<span class="line"><span>    # buffer size. This value has also been suggested in DNS Flag Day 2020.</span></span>
<span class="line"><span>    edns-buffer-size: 1232</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # Perform prefetching of close to expired message cache entries</span></span>
<span class="line"><span>    # This only applies to domains that have been frequently queried</span></span>
<span class="line"><span>    prefetch: yes</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # One thread should be sufficient, can be increased on beefy machines. In reality for most users running on small networks or on a single machine, it should be unnecessary to seek performance enhancement by increasing num-threads above 1.</span></span>
<span class="line"><span>    num-threads: 1</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # Ensure kernel buffer is large enough to not lose messages in traffic spikes</span></span>
<span class="line"><span>    so-rcvbuf: 1m</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # Ensure privacy of local IP ranges</span></span>
<span class="line"><span>    private-address: 192.168.0.0/16</span></span>
<span class="line"><span>    private-address: 169.254.0.0/16</span></span>
<span class="line"><span>    private-address: 172.16.0.0/12</span></span>
<span class="line"><span>    private-address: 10.0.0.0/8</span></span>
<span class="line"><span>    private-address: fd00::/8</span></span>
<span class="line"><span>    private-address: fe80::/10</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # Ensure no reverse queries to non-public IP ranges (RFC6303 4.2)</span></span>
<span class="line"><span>    private-address: 192.0.2.0/24</span></span>
<span class="line"><span>    private-address: 198.51.100.0/24</span></span>
<span class="line"><span>    private-address: 203.0.113.0/24</span></span>
<span class="line"><span>    private-address: 255.255.255.255/32</span></span>
<span class="line"><span>    private-address: 2001:db8::/32</span></span></code></pre><button class="code-block-unfold-btn"></button></div><hr><h2 lang="zh-CN" id="防火墙配置-firewalld" tabindex="-1">防火墙配置 - Firewalld <a class="header-anchor" href="#防火墙配置-firewalld" aria-label="Permalink to &quot;防火墙配置 - Firewalld {lang=&quot;zh-CN&quot;}&quot;">​</a></h2><p><strong>基本防火墙配置：</strong></p><div class="language-bash"><button title="Copy code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code v-pre=""><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 安装 firewalld</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> firewalld</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 启用服务</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> firewalld</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> firewalld</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 开放必要端口</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --permanent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --add-port=8384/tcp</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  # Syncthing</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --permanent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --add-port=9090/tcp</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  # Cockpit</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --permanent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --add-port=9443/tcp</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  # Portainer</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --permanent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --add-port=80/tcp</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    # Nextcloud</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --permanent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --add-port=5678/tcp</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  # n8n</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --permanent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --add-port=11434/tcp</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> # Ollama</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 重载防火墙规则</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --reload</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 查看开放的端口</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --list-ports</span></span></code></pre><button class="code-block-unfold-btn"></button></div><hr><h2 lang="zh-CN" id="自动化备份策略" tabindex="-1">自动化备份策略 <a class="header-anchor" href="#自动化备份策略" aria-label="Permalink to &quot;自动化备份策略 {lang=&quot;zh-CN&quot;}&quot;">​</a></h2><h3 lang="zh-CN" id="rclone-云端备份" tabindex="-1">Rclone 云端备份 <a class="header-anchor" href="#rclone-云端备份" aria-label="Permalink to &quot;Rclone 云端备份 {lang=&quot;zh-CN&quot;}&quot;">​</a></h3><p><strong>Rclone 配置：</strong></p><div class="language-bash"><button title="Copy code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code v-pre=""><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 安装 Rclone</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">curl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> https://rclone.org/install.sh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> bash</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 配置云存储（以 Google Drive 为例）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">rclone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> config</span></span></code></pre><button class="code-block-unfold-btn"></button></div><p><strong>手动备份命令示例：</strong></p><div class="language-bash"><button title="Copy code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code v-pre=""><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 备份重要数据到 Google Drive</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">rclone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> sync</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/important-data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> gdrive:backup/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">date</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> +%Y-%m-%d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">--log-file=/var/log/rclone.log</span></span></code></pre><button class="code-block-unfold-btn"></button></div><hr><h2 lang="zh-CN" id="tailscale-vpn-网络集成" tabindex="-1">Tailscale VPN 网络集成 <a class="header-anchor" href="#tailscale-vpn-网络集成" aria-label="Permalink to &quot;Tailscale VPN 网络集成 {lang=&quot;zh-CN&quot;}&quot;">​</a></h2><h3 lang="zh-CN" id="为什么使用-tailscale" tabindex="-1">为什么使用 Tailscale？ <a class="header-anchor" href="#为什么使用-tailscale" aria-label="Permalink to &quot;为什么使用 Tailscale？ {lang=&quot;zh-CN&quot;}&quot;">​</a></h3><ol><li><strong>零配置</strong>：无需复杂的 VPN 服务器配置</li><li><strong>点对点连接</strong>：设备间直接通信，延迟更低</li><li><strong>安全加密</strong>：基于 WireGuard 的现代加密技术</li><li><strong>跨平台支持</strong>：支持所有主流操作系统</li></ol><p><strong>网络拓扑：</strong></p><div class="language-"><button title="Copy code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code v-pre=""><span class="line"><span>Internet</span></span>
<span class="line"><span>    ↓</span></span>
<span class="line"><span>Cloudflare Zero Trust (公网访问)</span></span>
<span class="line"><span>    ↓</span></span>
<span class="line"><span>Home WiFi Router</span></span>
<span class="line"><span>    ├── Main Server (i5-6600T, WiFi)</span></span>
<span class="line"><span>    ├── Pi Zero 2W (DNS + 监控)</span></span>
<span class="line"><span>    └── Tailscale Subnet Router</span></span>
<span class="line"><span>              ↓</span></span>
<span class="line"><span>        Tailscale Network</span></span>
<span class="line"><span>    ├── Laptop (移动办公)</span></span>
<span class="line"><span>    ├── Phone (随时访问)</span></span>
<span class="line"><span>    └── Remote VPS (异地备份)</span></span></code></pre><button class="code-block-unfold-btn"></button></div><hr><h2 lang="zh-CN" id="安全性考虑与最佳实践" tabindex="-1">安全性考虑与最佳实践 <a class="header-anchor" href="#安全性考虑与最佳实践" aria-label="Permalink to &quot;安全性考虑与最佳实践 {lang=&quot;zh-CN&quot;}&quot;">​</a></h2><h3 lang="zh-CN" id="_1-网络安全" tabindex="-1">1. 网络安全 <a class="header-anchor" href="#_1-网络安全" aria-label="Permalink to &quot;1. 网络安全 {lang=&quot;zh-CN&quot;}&quot;">​</a></h3><ul><li><strong>Zero Trust 原则</strong>：所有连接都需要验证</li><li><strong>Firewalld 防火墙</strong>：只开放必要的端口</li><li><strong>定期安全更新</strong>：自动化补丁管理</li></ul><h3 lang="zh-CN" id="_2-数据保护" tabindex="-1">2. 数据保护 <a class="header-anchor" href="#_2-数据保护" aria-label="Permalink to &quot;2. 数据保护 {lang=&quot;zh-CN&quot;}&quot;">​</a></h3><ul><li><strong>多重备份</strong>：本地 + 云端备份</li><li><strong>加密存储</strong>：敏感数据加密存储</li><li><strong>访问日志</strong>：记录所有访问行为</li></ul><h3 lang="zh-CN" id="_3-监控告警" tabindex="-1">3. 监控告警 <a class="header-anchor" href="#_3-监控告警" aria-label="Permalink to &quot;3. 监控告警 {lang=&quot;zh-CN&quot;}&quot;">​</a></h3><ul><li><strong>系统监控</strong>：通过 Cockpit 监控系统状态</li><li><strong>服务监控</strong>：关键服务可用性检查</li><li><strong>安全监控</strong>：异常访问行为检测</li></ul><hr><h2 lang="zh-CN" id="成本分析" tabindex="-1">成本分析 <a class="header-anchor" href="#成本分析" aria-label="Permalink to &quot;成本分析 {lang=&quot;zh-CN&quot;}&quot;">​</a></h2><table><thead><tr><th>项目</th><th>费用</th><th>备注</th></tr></thead><tbody><tr><td>域名</td><td>RM 0</td><td>DigitalPlat 免费域名</td></tr><tr><td>Cloudflare Zero Trust</td><td>RM 0</td><td>免费套餐（50用户以下）</td></tr><tr><td>Tailscale</td><td>RM 0</td><td>免费套餐（20设备以下）</td></tr><tr><td>主服务器 (i5-6600T + 12GB RAM + 256GB SSD)</td><td>RM 400</td><td>一次性投入</td></tr><tr><td>Pi Zero 2W</td><td>RM 80</td><td>一次性投入</td></tr></tbody></table><p><strong>总成本</strong>：RM 480 一次性投入，后续运营成本几乎为零！</p><hr><h2 lang="zh-CN" id="未来扩展计划" tabindex="-1">未来扩展计划 <a class="header-anchor" href="#未来扩展计划" aria-label="Permalink to &quot;未来扩展计划 {lang=&quot;zh-CN&quot;}&quot;">​</a></h2><ol><li><p><strong>添加更多服务</strong></p><ul><li>Home Assistant（智能家居控制）</li><li>Grafana（数据可视化）</li><li>GitLab（代码仓库）</li></ul></li><li><p><strong>硬件升级</strong></p><ul><li>增加存储容量</li><li>升级内存到 16GB</li><li>添加 UPS 不间断电源</li></ul></li><li><p><strong>网络优化</strong></p><ul><li>考虑有线网络连接</li><li>部署高可用集群</li><li>增加异地容灾节点</li></ul></li></ol><hr><h2 lang="zh-CN" id="结语" tabindex="-1">结语 <a class="header-anchor" href="#结语" aria-label="Permalink to &quot;结语 {lang=&quot;zh-CN&quot;}&quot;">​</a></h2><p>经过几天的运行，这套基于免费域名和 Cloudflare Zero Trust 的 Homelab 方案已经完全满足了我的需求。它不仅提供了稳定可靠的服务，还大大提高了我的工作效率。</p><p><strong>关键优势总结：</strong></p><ul><li>✅ <strong>低成本投入</strong>：仅 RM 480 一次性硬件投入</li><li>✅ <strong>企业级安全</strong>：Cloudflare 提供的安全保护</li><li>✅ <strong>高度自动化</strong>：减少人工干预，提高效率</li><li>✅ <strong>隐私保护</strong>：数据完全自主可控</li><li>✅ <strong>易于维护</strong>：统一的管理界面</li></ul><p>如果你也想搭建自己的 Homelab，但又不想花费太多成本，这套方案绝对值得尝试。记住，最好的技术方案不是最复杂的，而是最适合自己需求的！</p></div><div lang="en"><h2 lang="en" id="introduction" tabindex="-1">Introduction <a class="header-anchor" href="#introduction" aria-label="Permalink to &quot;Introduction {lang=&quot;en&quot;}&quot;">​</a></h2><p>As a tech enthusiast who loves tinkering, I’ve always wanted to build my own homelab. Something that works on my local network, can be securely accessed from the internet, and has automation features to boost productivity. After some research and practice, I successfully built a modern homelab solution based on a free domain and Cloudflare Zero Trust.</p><hr><h2 lang="en" id="why-choose-this-solution" tabindex="-1">Why Choose This Solution? <a class="header-anchor" href="#why-choose-this-solution" aria-label="Permalink to &quot;Why Choose This Solution? {lang=&quot;en&quot;}&quot;">​</a></h2><p>There are many homelab solutions available, but most either require expensive domains and certificates or lack adequate security. I chose this solution because:</p><ol><li><strong>Completely Free</strong> - Using DigitalPlat FreeDomain for free domain</li><li><strong>Secure and Reliable</strong> - Cloudflare Zero Trust provides enterprise-grade security</li><li><strong>Easy to Manage</strong> - Unified web interface for all services</li><li><strong>Highly Automated</strong> - n8n workflow automation, scheduled backups</li><li><strong>Privacy Protection</strong> - Pi-hole + Unbound combo protects DNS privacy</li></ol><blockquote><p>"The best homelab solution isn’t the most expensive one, but the one that fits your needs."</p></blockquote><hr><h2 lang="en" id="hardware-configuration-and-architecture" tabindex="-1">Hardware Configuration and Architecture <a class="header-anchor" href="#hardware-configuration-and-architecture" aria-label="Permalink to &quot;Hardware Configuration and Architecture {lang=&quot;en&quot;}&quot;">​</a></h2><p>My homelab uses a hybrid architecture, mainly including:</p><h3 lang="en" id="main-server-configuration" tabindex="-1">Main Server Configuration <a class="header-anchor" href="#main-server-configuration" aria-label="Permalink to &quot;Main Server Configuration {lang=&quot;en&quot;}&quot;">​</a></h3><ul><li><strong>CPU</strong>: Intel i5-6600T processor</li><li><strong>Memory</strong>: 12GB DDR4</li><li><strong>Storage</strong>: 256GB SSD</li><li><strong>Network</strong>: WiFi connection</li></ul><h3 lang="en" id="supporting-devices" tabindex="-1">Supporting Devices <a class="header-anchor" href="#supporting-devices" aria-label="Permalink to &quot;Supporting Devices {lang=&quot;en&quot;}&quot;">​</a></h3><ul><li><strong>Raspberry Pi Zero 2W</strong>: Energy-efficient solution for DNS server and lightweight services</li><li><strong>Tailscale VPN</strong>: Connecting all devices into a private network</li></ul><hr><h2 lang="en" id="core-service-architecture" tabindex="-1">Core Service Architecture <a class="header-anchor" href="#core-service-architecture" aria-label="Permalink to &quot;Core Service Architecture {lang=&quot;en&quot;}&quot;">​</a></h2><h3 lang="en" id="main-server-service-list" tabindex="-1">Main Server Service List <a class="header-anchor" href="#main-server-service-list" aria-label="Permalink to &quot;Main Server Service List {lang=&quot;en&quot;}&quot;">​</a></h3><table><thead><tr><th>Service Name</th><th>Domain</th><th>Port</th><th>Description</th></tr></thead><tbody><tr><td><strong>Syncthing</strong></td><td>syncthing.example.dpdns.org</td><td>8384</td><td>File synchronization service</td></tr><tr><td><strong>Cockpit</strong></td><td>cockpit.example.dpdns.org</td><td>9090</td><td>System monitoring panel</td></tr><tr><td><strong>Portainer</strong></td><td>portainer.example.dpdns.org</td><td>9443</td><td>Docker container management</td></tr><tr><td><strong>Nextcloud</strong></td><td>nextcloud.example.dpdns.org</td><td>80</td><td>Private cloud storage</td></tr><tr><td><strong>n8n</strong></td><td>n8n.example.dpdns.org</td><td>5678</td><td>Workflow automation</td></tr><tr><td><strong>Ollama</strong></td><td>ollama.example.dpdns.org</td><td>11434</td><td>Local AI model service</td></tr></tbody></table><h3 lang="en" id="pi-zero-2w-service-list" tabindex="-1">Pi Zero 2W Service List <a class="header-anchor" href="#pi-zero-2w-service-list" aria-label="Permalink to &quot;Pi Zero 2W Service List {lang=&quot;en&quot;}&quot;">​</a></h3><table><thead><tr><th>Service Name</th><th>Domain</th><th>Port</th><th>Description</th></tr></thead><tbody><tr><td><strong>Pi Syncthing</strong></td><td>pi-syncthing.example.dpdns.org</td><td>8384</td><td>Backup file sync</td></tr><tr><td><strong>Pi-hole</strong></td><td>pihole.example.dpdns.org</td><td>80</td><td>DNS ad blocking</td></tr></tbody></table><hr><h2 lang="en" id="free-domain-application-and-configuration" tabindex="-1">Free Domain Application and Configuration <a class="header-anchor" href="#free-domain-application-and-configuration" aria-label="Permalink to &quot;Free Domain Application and Configuration {lang=&quot;en&quot;}&quot;">​</a></h2><h3 lang="en" id="step-1-apply-for-digitalplat-freedomain" tabindex="-1">Step 1: Apply for DigitalPlat FreeDomain <a class="header-anchor" href="#step-1-apply-for-digitalplat-freedomain" aria-label="Permalink to &quot;Step 1: Apply for DigitalPlat FreeDomain {lang=&quot;en&quot;}&quot;">​</a></h3><ol><li>Visit <strong>DigitalPlat FreeDomain – NIC</strong> official website</li><li>Select appropriate free domain suffix (I chose <code>.dpdns.org</code>)</li><li>Register domain (using generic example domain to avoid exposing real information)</li><li>Complete domain verification</li></ol><h3 lang="en" id="step-2-migrate-to-cloudflare" tabindex="-1">Step 2: Migrate to Cloudflare <a class="header-anchor" href="#step-2-migrate-to-cloudflare" aria-label="Permalink to &quot;Step 2: Migrate to Cloudflare {lang=&quot;en&quot;}&quot;">​</a></h3><ol><li>Add domain in Cloudflare</li><li>Change DigitalPlat Name Servers to Cloudflare provided NS</li><li>Wait for DNS propagation (usually takes 24-48 hours)</li></ol><blockquote><p><strong>Tip</strong>: Free domains have limited features, but they’re completely sufficient for homelab use.</p></blockquote><hr><h2 lang="en" id="cloudflare-zero-trust-tunnel-configuration" tabindex="-1">Cloudflare Zero Trust Tunnel Configuration <a class="header-anchor" href="#cloudflare-zero-trust-tunnel-configuration" aria-label="Permalink to &quot;Cloudflare Zero Trust Tunnel Configuration {lang=&quot;en&quot;}&quot;">​</a></h2><h3 lang="en" id="using-web-gui-to-configure-tunnels" tabindex="-1">Using Web GUI to Configure Tunnels <a class="header-anchor" href="#using-web-gui-to-configure-tunnels" aria-label="Permalink to &quot;Using Web GUI to Configure Tunnels {lang=&quot;en&quot;}&quot;">​</a></h3><p>I chose to configure tunnels through the Cloudflare Zero Trust web interface, which is more intuitive and convenient:</p><ol><li><p><strong>Login to Cloudflare Zero Trust Console</strong></p></li><li><p><strong>Create Tunnel</strong>:</p><ul><li>Go to Access → Tunnels</li><li>Click "Create a tunnel"</li><li>Select "Cloudflared" as connector type</li><li>Name your tunnel (e.g., "homelab-main")</li></ul></li><li><p><strong>Install Cloudflared</strong>:</p><div class="language-bash"><button title="Copy code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code v-pre=""><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Ubuntu/Debian - follow the commands shown in console</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -L</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --output</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cloudflared.deb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-amd64.deb</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dpkg</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cloudflared.deb</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Run the connection command provided by console</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cloudflared</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> install</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [YOUR_TOKEN_HERE]</span></span></code></pre><button class="code-block-unfold-btn"></button></div></li><li><p><strong>Configure Public Hostnames</strong>: Add the following service mappings in the web interface:</p><ul><li><code>syncthing.example.dpdns.org</code> → <code>http://localhost:8384</code></li><li><code>cockpit.example.dpdns.org</code> → <code>https://localhost:9090</code></li><li><code>portainer.example.dpdns.org</code> → <code>https://localhost:9443</code></li><li><code>nextcloud.example.dpdns.org</code> → <code>http://localhost:80</code></li><li><code>n8n.example.dpdns.org</code> → <code>http://localhost:5678</code></li><li><code>ollama.example.dpdns.org</code> → <code>http://127.0.0.1:11434</code></li></ul></li></ol><hr><h2 lang="en" id="core-service-deployment-details" tabindex="-1">Core Service Deployment Details <a class="header-anchor" href="#core-service-deployment-details" aria-label="Permalink to &quot;Core Service Deployment Details {lang=&quot;en&quot;}&quot;">​</a></h2><h3 lang="en" id="_1-file-synchronization-service-syncthing" tabindex="-1">1. File Synchronization Service - Syncthing <a class="header-anchor" href="#_1-file-synchronization-service-syncthing" aria-label="Permalink to &quot;1. File Synchronization Service - Syncthing {lang=&quot;en&quot;}&quot;">​</a></h3><p><strong>Why Choose Syncthing?</strong></p><ul><li>Decentralized, no third-party servers needed</li><li>End-to-end encryption, privacy secure</li><li>Cross-platform support, seamless device sync</li></ul><p><strong>APT Installation Configuration:</strong></p><div class="language-bash"><button title="Copy code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code v-pre=""><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Add official APT repository</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /etc/apt/keyrings</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -L</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /etc/apt/keyrings/syncthing-archive-keyring.gpg</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> https://syncthing.net/release-key.gpg</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "deb [signed-by=/etc/apt/keyrings/syncthing-archive-keyring.gpg] https://apt.syncthing.net/ syncthing stable"</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tee</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /etc/apt/sources.list.d/syncthing.list</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Install Syncthing</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> update</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> syncthing</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Enable system service</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> syncthing@</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$USER</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> syncthing@</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$USER</span></span></code></pre><button class="code-block-unfold-btn"></button></div><p>Through Syncthing, all my devices (phone, laptop, server) stay in sync, no more worrying about file loss or version conflicts.</p><h3 lang="en" id="_2-workflow-automation-n8n-docker" tabindex="-1">2. Workflow Automation - n8n (Docker) <a class="header-anchor" href="#_2-workflow-automation-n8n-docker" aria-label="Permalink to &quot;2. Workflow Automation - n8n (Docker) {lang=&quot;en&quot;}&quot;">​</a></h3><p><strong>Docker Deployment for n8n:</strong></p><div class="language-bash"><button title="Copy code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code v-pre=""><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Create data directory</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> volume</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> n8n_data</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Run n8n container</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> n8n</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --network=host</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> n8n_data:/home/node/.n8n</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> N8N_HOST=n8n.example.dpdns.org</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> WEBHOOK_URL=https://n8n.example.dpdns.org</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> VUE_APP_URL_BASE_API=https://n8n.example.dpdns.org</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> N8N_PROTOCOL=https</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> N8N_SECURE_COOKIE=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">false</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> N8N_LISTEN_ADDRESS=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0.0.0.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> N8N_RUNNERS_ENABLED=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> N8N_ENFORCE_SETTINGS_FILE_PERMISSIONS=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> unless-stopped</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  docker.n8n.io/n8nio/n8n</span></span></code></pre><button class="code-block-unfold-btn"></button></div><p><strong>My Automation Scenarios:</strong></p><ul><li><strong>File Backup Automation</strong>: Auto backup to cloud when important files change</li><li><strong>System Monitoring Alerts</strong>: Send notifications to phone when server resources are abnormal</li><li><strong>Scheduled Task Management</strong>: Auto cleanup temporary files, update system patches</li></ul><h3 lang="en" id="_3-container-management-portainer-docker" tabindex="-1">3. Container Management - Portainer (Docker) <a class="header-anchor" href="#_3-container-management-portainer-docker" aria-label="Permalink to &quot;3. Container Management - Portainer (Docker) {lang=&quot;en&quot;}&quot;">​</a></h3><p><strong>Docker Deployment for Portainer:</strong></p><div class="language-bash"><button title="Copy code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code v-pre=""><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Create data volume</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> volume</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> portainer_data</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Run Portainer container</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 8000:8000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 9443:9443</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> portainer</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --restart=always</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /var/run/docker.sock:/var/run/docker.sock</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> portainer_data:/data</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  portainer/portainer-ce:lts</span></span></code></pre><button class="code-block-unfold-btn"></button></div><h3 lang="en" id="_4-dns-filtering-and-privacy-protection-pi-hole-unbound" tabindex="-1">4. DNS Filtering and Privacy Protection - Pi-hole + Unbound <a class="header-anchor" href="#_4-dns-filtering-and-privacy-protection-pi-hole-unbound" aria-label="Permalink to &quot;4. DNS Filtering and Privacy Protection - Pi-hole + Unbound {lang=&quot;en&quot;}&quot;">​</a></h3><p><strong>Pi-hole Configuration:</strong></p><div class="language-bash"><button title="Copy code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code v-pre=""><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Install Pi-hole</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -sSL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> https://install.pi-hole.net</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> bash</span></span></code></pre><button class="code-block-unfold-btn"></button></div><p><strong>Unbound Configuration (Following Official Documentation):</strong></p><p>Following the <a href="https://docs.pi-hole.net/guides/dns/unbound/" target="_blank" rel="noreferrer">Pi-hole official Unbound guide</a>:</p><div class="language-bash"><button title="Copy code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code v-pre=""><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Install Unbound</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> unbound</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Create configuration file</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /etc/unbound/unbound.conf.d/pi-hole.conf</span></span></code></pre><button class="code-block-unfold-btn"></button></div><p><strong>Configuration Content:</strong></p><div class="language-"><button title="Copy code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code v-pre=""><span class="line"><span>server:</span></span>
<span class="line"><span>    # If no logfile is specified, syslog is used</span></span>
<span class="line"><span>    # logfile: "/var/log/unbound/unbound.log"</span></span>
<span class="line"><span>    verbosity: 0</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    interface: 127.0.0.1</span></span>
<span class="line"><span>    port: 5335</span></span>
<span class="line"><span>    do-ip4: yes</span></span>
<span class="line"><span>    do-udp: yes</span></span>
<span class="line"><span>    do-tcp: yes</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # May be set to no if you don't have IPv6 connectivity</span></span>
<span class="line"><span>    do-ip6: yes</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # You want to leave this to no unless you have *native* IPv6. With 6to4 and</span></span>
<span class="line"><span>    # Terredo tunnels your web browser should favor IPv4 for the same reasons</span></span>
<span class="line"><span>    prefer-ip6: no</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # Use this only when you downloaded the list of primary root servers!</span></span>
<span class="line"><span>    # If you use the default dns-root-data package, unbound will find it automatically</span></span>
<span class="line"><span>    #root-hints: "/var/lib/unbound/root.hints"</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # Trust glue only if it is within the server's authority</span></span>
<span class="line"><span>    harden-glue: yes</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # Require DNSSEC data for trust-anchored zones, if such data is absent, the zone becomes BOGUS</span></span>
<span class="line"><span>    harden-dnssec-stripped: yes</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # Don't use Capitalization randomization as it known to cause DNSSEC issues sometimes</span></span>
<span class="line"><span>    # see https://discourse.pi-hole.net/t/unbound-stubby-or-dnscrypt-proxy/9378 for further details</span></span>
<span class="line"><span>    use-caps-for-id: no</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # Reduce EDNS reassembly buffer size.</span></span>
<span class="line"><span>    # IP fragmentation is unreliable on the Internet today, and can cause</span></span>
<span class="line"><span>    # transmission failures when large DNS messages are sent via UDP. Even</span></span>
<span class="line"><span>    # when fragmentation does work, it may not be secure; it is theoretically</span></span>
<span class="line"><span>    # possible to spoof parts of a fragmented DNS message, without easy</span></span>
<span class="line"><span>    # detection at the receiving end. Recently, there was an excellent study</span></span>
<span class="line"><span>    # &gt;&gt;&gt; Defragmenting DNS - Determining the optimal maximum UDP response size for DNS &lt;&lt;&lt;</span></span>
<span class="line"><span>    # by Axel Koolhaas, and Tjeerd Slokker (https://indico.dns-oarc.net/event/36/contributions/776/)</span></span>
<span class="line"><span>    # in collaboration with NLnet Labs explored DNS using real world data from the</span></span>
<span class="line"><span>    # the RIPE Atlas probes and the researchers suggested different values for</span></span>
<span class="line"><span>    # IPv4 and IPv6 and in different scenarios. They advise that servers should</span></span>
<span class="line"><span>    # be configured to limit DNS messages sent over UDP to a size that will not</span></span>
<span class="line"><span>    # trigger fragmentation on typical network links. DNS servers can switch</span></span>
<span class="line"><span>    # from UDP to TCP when a DNS response is too big to fit in this limited</span></span>
<span class="line"><span>    # buffer size. This value has also been suggested in DNS Flag Day 2020.</span></span>
<span class="line"><span>    edns-buffer-size: 1232</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # Perform prefetching of close to expired message cache entries</span></span>
<span class="line"><span>    # This only applies to domains that have been frequently queried</span></span>
<span class="line"><span>    prefetch: yes</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # One thread should be sufficient, can be increased on beefy machines. In reality for most users running on small networks or on a single machine, it should be unnecessary to seek performance enhancement by increasing num-threads above 1.</span></span>
<span class="line"><span>    num-threads: 1</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # Ensure kernel buffer is large enough to not lose messages in traffic spikes</span></span>
<span class="line"><span>    so-rcvbuf: 1m</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # Ensure privacy of local IP ranges</span></span>
<span class="line"><span>    private-address: 192.168.0.0/16</span></span>
<span class="line"><span>    private-address: 169.254.0.0/16</span></span>
<span class="line"><span>    private-address: 172.16.0.0/12</span></span>
<span class="line"><span>    private-address: 10.0.0.0/8</span></span>
<span class="line"><span>    private-address: fd00::/8</span></span>
<span class="line"><span>    private-address: fe80::/10</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # Ensure no reverse queries to non-public IP ranges (RFC6303 4.2)</span></span>
<span class="line"><span>    private-address: 192.0.2.0/24</span></span>
<span class="line"><span>    private-address: 198.51.100.0/24</span></span>
<span class="line"><span>    private-address: 203.0.113.0/24</span></span>
<span class="line"><span>    private-address: 255.255.255.255/32</span></span>
<span class="line"><span>    private-address: 2001:db8::/32</span></span></code></pre><button class="code-block-unfold-btn"></button></div><hr><h2 lang="en" id="firewall-configuration-firewalld" tabindex="-1">Firewall Configuration - Firewalld <a class="header-anchor" href="#firewall-configuration-firewalld" aria-label="Permalink to &quot;Firewall Configuration - Firewalld {lang=&quot;en&quot;}&quot;">​</a></h2><p><strong>Basic Firewall Configuration:</strong></p><div class="language-bash"><button title="Copy code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code v-pre=""><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Install firewalld</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> firewalld</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Enable service</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> firewalld</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> firewalld</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Open necessary ports</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --permanent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --add-port=8384/tcp</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  # Syncthing</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --permanent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --add-port=9090/tcp</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  # Cockpit</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --permanent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --add-port=9443/tcp</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  # Portainer</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --permanent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --add-port=80/tcp</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    # Nextcloud</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --permanent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --add-port=5678/tcp</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  # n8n</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --permanent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --add-port=11434/tcp</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> # Ollama</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Reload firewall rules</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --reload</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Check open ports</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --list-ports</span></span></code></pre><button class="code-block-unfold-btn"></button></div><hr><h2 lang="en" id="automated-backup-strategy" tabindex="-1">Automated Backup Strategy <a class="header-anchor" href="#automated-backup-strategy" aria-label="Permalink to &quot;Automated Backup Strategy {lang=&quot;en&quot;}&quot;">​</a></h2><h3 lang="en" id="rclone-cloud-backup" tabindex="-1">Rclone Cloud Backup <a class="header-anchor" href="#rclone-cloud-backup" aria-label="Permalink to &quot;Rclone Cloud Backup {lang=&quot;en&quot;}&quot;">​</a></h3><p><strong>Rclone Configuration:</strong></p><div class="language-bash"><button title="Copy code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code v-pre=""><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Install Rclone</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">curl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> https://rclone.org/install.sh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> bash</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Configure cloud storage (Google Drive example)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">rclone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> config</span></span></code></pre><button class="code-block-unfold-btn"></button></div><p><strong>Manual Backup Command Examples:</strong></p><div class="language-bash"><button title="Copy code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code v-pre=""><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Backup important data to Google Drive</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">rclone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> sync</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/important-data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> gdrive:backup/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">date</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> +%Y-%m-%d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">--log-file=/var/log/rclone.log</span></span></code></pre><button class="code-block-unfold-btn"></button></div><hr><h2 lang="en" id="tailscale-vpn-network-integration" tabindex="-1">Tailscale VPN Network Integration <a class="header-anchor" href="#tailscale-vpn-network-integration" aria-label="Permalink to &quot;Tailscale VPN Network Integration {lang=&quot;en&quot;}&quot;">​</a></h2><h3 lang="en" id="why-use-tailscale" tabindex="-1">Why Use Tailscale? <a class="header-anchor" href="#why-use-tailscale" aria-label="Permalink to &quot;Why Use Tailscale? {lang=&quot;en&quot;}&quot;">​</a></h3><ol><li><strong>Zero Configuration</strong>: No complex VPN server setup needed</li><li><strong>Peer-to-Peer Connection</strong>: Direct device communication, lower latency</li><li><strong>Secure Encryption</strong>: Modern encryption based on WireGuard</li><li><strong>Cross-Platform Support</strong>: Supports all major operating systems</li></ol><p><strong>Network Topology:</strong></p><div class="language-"><button title="Copy code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code v-pre=""><span class="line"><span>Internet</span></span>
<span class="line"><span>    ↓</span></span>
<span class="line"><span>Cloudflare Zero Trust (Public Access)</span></span>
<span class="line"><span>    ↓</span></span>
<span class="line"><span>Home WiFi Router</span></span>
<span class="line"><span>    ├── Main Server (i5-6600T, WiFi)</span></span>
<span class="line"><span>    ├── Pi Zero 2W (DNS + Monitoring)</span></span>
<span class="line"><span>    └── Tailscale Subnet Router</span></span>
<span class="line"><span>              ↓</span></span>
<span class="line"><span>        Tailscale Network</span></span>
<span class="line"><span>    ├── Laptop (Mobile Work)</span></span>
<span class="line"><span>    ├── Phone (Anytime Access)</span></span>
<span class="line"><span>    └── Remote VPS (Off-site Backup)</span></span></code></pre><button class="code-block-unfold-btn"></button></div><hr><h2 lang="en" id="security-considerations-and-best-practices" tabindex="-1">Security Considerations and Best Practices <a class="header-anchor" href="#security-considerations-and-best-practices" aria-label="Permalink to &quot;Security Considerations and Best Practices {lang=&quot;en&quot;}&quot;">​</a></h2><h3 lang="en" id="_1-network-security" tabindex="-1">1. Network Security <a class="header-anchor" href="#_1-network-security" aria-label="Permalink to &quot;1. Network Security {lang=&quot;en&quot;}&quot;">​</a></h3><ul><li><strong>Zero Trust Principle</strong>: All connections require verification</li><li><strong>Firewalld Firewall</strong>: Only open necessary ports</li><li><strong>Regular Security Updates</strong>: Automated patch management</li></ul><h3 lang="en" id="_2-data-protection" tabindex="-1">2. Data Protection <a class="header-anchor" href="#_2-data-protection" aria-label="Permalink to &quot;2. Data Protection {lang=&quot;en&quot;}&quot;">​</a></h3><ul><li><strong>Multiple Backups</strong>: Local + Cloud backup</li><li><strong>Encrypted Storage</strong>: Sensitive data encrypted storage</li><li><strong>Access Logs</strong>: Record all access behavior</li></ul><h3 lang="en" id="_3-monitoring-and-alerting" tabindex="-1">3. Monitoring and Alerting <a class="header-anchor" href="#_3-monitoring-and-alerting" aria-label="Permalink to &quot;3. Monitoring and Alerting {lang=&quot;en&quot;}&quot;">​</a></h3><ul><li><strong>System Monitoring</strong>: Monitor system status through Cockpit</li><li><strong>Service Monitoring</strong>: Critical service availability checks</li><li><strong>Security Monitoring</strong>: Abnormal access behavior detection</li></ul><hr><h2 lang="en" id="cost-analysis" tabindex="-1">Cost Analysis <a class="header-anchor" href="#cost-analysis" aria-label="Permalink to &quot;Cost Analysis {lang=&quot;en&quot;}&quot;">​</a></h2><table><thead><tr><th>Item</th><th>Cost</th><th>Notes</th></tr></thead><tbody><tr><td>Domain</td><td>MYR 0</td><td>DigitalPlat free domain</td></tr><tr><td>Cloudflare Zero Trust</td><td>MYR 0</td><td>Free tier (under 50 users)</td></tr><tr><td>Tailscale</td><td>MYR 0</td><td>Free tier (under 20 devices)</td></tr><tr><td>Main Server (i5-6600T + 12GB RAM + 256GB SSD)</td><td>MYR 400</td><td>One-time investment</td></tr><tr><td>Pi Zero 2W</td><td>MYR 80</td><td>One-time investment</td></tr></tbody></table><p><strong>Total Cost</strong>: MYR 480 one-time investment, ongoing operational costs are almost zero!</p><hr><h2 lang="en" id="future-expansion-plans" tabindex="-1">Future Expansion Plans <a class="header-anchor" href="#future-expansion-plans" aria-label="Permalink to &quot;Future Expansion Plans {lang=&quot;en&quot;}&quot;">​</a></h2><ol><li><p><strong>Add More Services</strong></p><ul><li>Home Assistant (smart home control)</li><li>Grafana (data visualization)</li><li>GitLab (code repository)</li></ul></li><li><p><strong>Hardware Upgrades</strong></p><ul><li>Increase storage capacity</li><li>Upgrade memory to 16GB</li><li>Add UPS uninterruptible power supply</li></ul></li><li><p><strong>Network Optimization</strong></p><ul><li>Consider wired network connection</li><li>Deploy high availability cluster</li><li>Add off-site disaster recovery nodes</li></ul></li></ol><hr><h2 lang="en" id="conclusion" tabindex="-1">Conclusion <a class="header-anchor" href="#conclusion" aria-label="Permalink to &quot;Conclusion {lang=&quot;en&quot;}&quot;">​</a></h2><p>After several days of operation, this homelab solution based on free domain and Cloudflare Zero Trust has completely met my needs. It not only provides stable and reliable services but also greatly improves my work efficiency.</p><p><strong>Key Advantages Summary:</strong></p><ul><li>✅ <strong>Low Cost Investment</strong>: Only MYR 480 one-time hardware investment</li><li>✅ <strong>Enterprise-Grade Security</strong>: Security protection provided by Cloudflare</li><li>✅ <strong>Highly Automated</strong>: Reduces manual intervention, improves efficiency</li><li>✅ <strong>Privacy Protection</strong>: Data completely under your control</li><li>✅ <strong>Easy to Maintain</strong>: Unified management interface</li></ul><p>If you also want to build your own homelab but don’t want to spend too much, this solution is definitely worth trying. Remember, the best technical solution isn’t the most complex one, but the one that best fits your needs!</p></div><!--]--><!--]--><!----><!----></article><!-- </Transition> --><!--]--><!--[--><!--[--><!--[--><div class="yun-sponsor-container flex-center flex-col" m="t-6"><button class="sponsor-button yun-icon-btn shadow hover:shadow-md" title="打赏" text="red-400"><div class="mt-2px" i-ri-heart-fill=""></div></button><div m="y-4" class="qrcode-container qrcode flex-center flex-col"><div class="sponsor-description" mb="4" text="sm">这是关于赞助的一些描述</div><div class="flex justify-around"><!--[--><!--]--></div></div></div><ul class="post-copyright" m="y-4"><li class="post-copyright-author"><strong>本文作者：</strong><span>小林</span></li><li class="post-copyright-link"><strong>本文链接：</strong><a href="https://djzzlim.github.io/posts/2025-07-24-homelab" target="_blank" title="本文链接">https://djzzlim.github.io/posts/2025-07-24-homelab</a></li><li class="post-copyright-license"><strong>版权声明：</strong><span>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 ">CC BY-NC-SA</a> 许可协议。</span></li></ul><!--]--><!--]--><!--]--></div><!--]--><!----></div><!--[--><!--]--><!--[--><div class="post-nav"><div class="post-nav-item"><a href="/posts/2025-03-26-cybersecurity-learning-journey" class="post-nav-prev" title="Beyond Textbooks：My Cybersecurity Learning Journey"><div class="icon" i-ri-arrow-left-s-line=""></div><span class="title truncate" text="sm">Beyond Textbooks：My Cybersecurity Learning Journey</span></a></div><div class="post-nav-item"><a href="/posts/2025-03-28-hackintosh-part-3" class="post-nav-next" title="How to Run macOS on a PC? – Hackintosh Guide Part 3"><span class="title truncate" text="sm">How to Run macOS on a PC? – Hackintosh Guide Part 3</span><div class="icon" i-ri-arrow-right-s-line=""></div></a></div></div><!--]--><!--[--><!--]--><!----><!--[--><!-- eslint-disable-next-line vue/no-lone-template empty --><template class="mt-4"></template><!--]--><!--[--><!--]--><!--[--><!--]--></div><!--]--></main><!--[--><button class="xl:hidden toc-btn shadow-md fixed yun-icon-btn z-20 bg-$va-c-bg-soft" opacity="75" right="4" bottom="19"><div i-ri-file-list-line=""></div></button><!----><aside flex="~ col" class="va-card yun-aside sticky top-0 lg:top-$yun-margin-top min-h-sm" text="center" overflow="auto"><div class="w-full" flex="~ col" pb-2="" style="display:none"><!--[--><h2 m="t-6 b-2" font="serif black">文章目录</h2><div style="display:none" data-v-6dc67c73=""><div class="content" data-v-6dc67c73=""><div class="outline-title" data-v-6dc67c73="">本页</div><div class="outline-marker" data-v-6dc67c73=""></div><nav aria-labelledby="doc-outline-aria-label" data-v-6dc67c73=""><span id="doc-outline-aria-label" class="visually-hidden" data-v-6dc67c73="">Table of Contents for current page</span><ul class="root va-toc relative z-1 css-i18n-toc" data-v-6dc67c73="" data-v-699db71a=""><!--[--><!--]--></ul></nav></div></div><!--]--><div class="flex-grow"></div><!----></div></aside><!--]--><!--]--></div><footer flex="~ col" class="relative yun-footer va-footer px-4 py-4 pt-0 text-$va-c-text-light w-full mt-14" bg="white dark:$va-c-bg-soft" text="center sm"><div class="yun-cloud absolute top--10 left-0 right-0"><svg class="waves" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" fill="var(--yun-c-cloud)"></path></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"></use><use xlink:href="#gentle-wave" x="48" y="3"></use><use xlink:href="#gentle-wave" x="48" y="5"></use><use xlink:href="#gentle-wave" x="48" y="7"></use></g></svg></div><!----><div class="copyright flex justify-center items-center gap-2" p="1"><span>©<!----> 2025</span><a class="animate-pulse inline-flex" href="https://www.yunyoujun.cn/sponsors/" target="_blank" title="Sponsor YunYouJun"><div class="i-ri-cloud-line"></div></a><span>小林</span></div><div class="powered" m="2"><span>由 <a href="git+https://github.com/YunYouJun/valaxy.git" target="_blank" rel="noopener">Valaxy</a> <span class="op-60">v0.26.10</span> 驱动</span><span mx-1="">|</span><span><span>主题</span><span mx-1="">-</span><a href="git+https://github.com/YunYouJun/valaxy/tree/main/packages/valaxy-theme-yun.git" title="valaxy-theme-yun" target="_blank">Yun</a><span class="ml-1 op-60">v0.26.10</span></span></div><!--[--><!--]--><div class="yun-footer-gradient" style="--gradient-from:161 196 253;--gradient-to:194 233 251"></div></footer><!--]--><!--]--></div><script>window.__INITIAL_STATE__='{"pinia":{"yun-app":{},"app":{"showLoading":true},"site":{},"routerStore":{}}}'</script><script type="application/ld+json" data-hid="schema-org-graph">{"@context":"https://schema.org","@graph":[{"@id":"https://djzzlim.github.io/#identity","@type":"Person","name":"小林","url":"https://djzzlim.github.io/","image":{"@id":"https://djzzlim.github.io/#/schema/image/9d75c4a"},"sameAs":["/atom.xml","https://github.com/djzzlim","https://t.me/djzzlim","mailto:limkarjoon221@gmail.com"]},{"@id":"https://djzzlim.github.io/#website","@type":"WebSite","dateModified":"2025-07-24","datePublished":"2025-07-24","inLanguage":"en","name":"Building a Modern Homelab with Free Domain and Cloudflare Zero Trust","url":"https://djzzlim.github.io/","publisher":{"@id":"https://djzzlim.github.io/#identity"}},{"@id":"https://djzzlim.github.io/#webpage","@type":"WebPage","dateModified":"2025-07-23T16:00:00.000Z","datePublished":"2025-07-23T16:00:00.000Z","description":"所以一直在记录","name":"Building a Modern Homelab with Free Domain and Cloudflare Zero Trust","url":"https://djzzlim.github.io/","about":{"@id":"https://djzzlim.github.io/#identity"},"isPartOf":{"@id":"https://djzzlim.github.io/#website"},"potentialAction":[{"@type":"ReadAction","target":["https://djzzlim.github.io/"]}]},{"@id":"https://djzzlim.github.io/#article","dateModified":"2025-07-23T16:00:00.000Z","datePublished":"2025-07-23T16:00:00.000Z","description":"所以一直在记录","headline":"Building a Modern Homelab with Free Domain and Cloudflare Zero Trust","inLanguage":"en","thumbnailUrl":"https://djzzlim.github.io/favicon.svg","@type":["Article","BlogPosting"],"author":{"@id":"https://djzzlim.github.io/#/schema/person/517ba3b"},"image":{"@id":"https://djzzlim.github.io/#/schema/image/341a9b5"},"isPartOf":{"@id":"https://djzzlim.github.io/#webpage"},"mainEntityOfPage":{"@id":"https://djzzlim.github.io/#webpage"},"publisher":{"@id":"https://djzzlim.github.io/#identity"}},{"@id":"https://djzzlim.github.io/#/schema/person/517ba3b","@type":"Person","name":"小林","url":"https://valaxy.site"},{"@id":"https://djzzlim.github.io/#/schema/image/9d75c4a","@type":"ImageObject","contentUrl":"https://avatars.githubusercontent.com/u/57754036?s=400&u=1b0ea34ae64633021445d42ccc30cc4c534fdc0a&v=4","inLanguage":"en","url":"https://avatars.githubusercontent.com/u/57754036?s=400&u=1b0ea34ae64633021445d42ccc30cc4c534fdc0a&v=4"},{"@id":"https://djzzlim.github.io/#/schema/image/341a9b5","@type":"ImageObject","contentUrl":"https://djzzlim.github.io/favicon.svg","inLanguage":"en","url":"https://djzzlim.github.io/favicon.svg"}]}</script></body></html>